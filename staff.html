<form id="staffForm">
  <label for="club">Club Name:</label>
  <input type="text" id="club" name="club" required><br>

  <div id="staffEntries">
    <div class="staff">
      <fieldset>
        <legend>Staff Member</legend>
        <label>Name: <input type="text" name="name" required></label><br>
        <label>Email: <input type="email" name="email" required></label><br>
        <label>CRC:
          <select name="crc">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </label><br>
        <label>First Aid:
          <select name="firstAid">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </label><br>
        <label>Driver's Abstract:
          <select name="driversAbstract">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </label><br>
        <label>Insurance:
          <select name="insurance">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </label><br>
        <label>Calendar Approved:
          <select name="calendarApproved">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </label><br>
        <label>Volunteers Approved:
          <select name="volunteersApproved">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </label><br>
        <label>
          <input type="checkbox" name="volunteerForm"> Volunteer Form Submitted
        </label><br>
        <hr>
      </fieldset>
    </div>
  </div>

  <button type="button" onclick="addStaffEntry()">+ Add Staff</button><br><br>
  <button type="submit">Submit</button>
</form>
function addStaffEntry() {
  const container = document.getElementById('staffEntries');
  const template = container.firstElementChild.cloneNode(true);
  template.querySelectorAll('input, select').forEach(input => {
    if (input.type === 'checkbox') {
      input.checked = false;
    } else {
      input.value = '';
    }
  });
  container.appendChild(template);
}

document.getElementById('staffForm').addEventListener('submit', async function (e) {
  e.preventDefault();

  const club = document.getElementById('club').value;
  const staffList = [];

  document.querySelectorAll('#staffEntries .staff').forEach(entry => {
    const name = entry.querySelector('[name="name"]').value;
    const email = entry.querySelector('[name="email"]').value;
    const crc = entry.querySelector('[name="crc"]').value;
    const firstAid = entry.querySelector('[name="firstAid"]').value;
    const driversAbstract = entry.querySelector('[name="driversAbstract"]').value;
    const insurance = entry.querySelector('[name="insurance"]').value;
    const calendarApproved = entry.querySelector('[name="calendarApproved"]').value;
    const volunteersApproved = entry.querySelector('[name="volunteersApproved"]').value;
    const volunteerForm = entry.querySelector('[name="volunteerForm"]').checked;

    staffList.push({ name, email, crc, firstAid, driversAbstract, insurance, calendarApproved, volunteersApproved, volunteerForm });
  });

  const payload = {
    club,
    staffList
  };

  const response = await fetch('https://script.google.com/macros/s/AKfycbzI8tWSQPCHnXW8Z8WmtpqHi33MvyjCCgGwg4D3LWOyYOK4RD7_23NEMFF97nvDCqa6bw/exec', {
    method: 'POST',
    body: JSON.stringify(payload),
    headers: { 'Content-Type': 'application/json' }
  });

  const result = await response.text();
  alert(result);
});
